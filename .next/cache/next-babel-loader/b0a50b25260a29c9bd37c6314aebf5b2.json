{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { css as _css } from \"styled-components\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from \"react\";\nimport Head from 'next/head';\nimport Axios from 'axios';\nimport dynamic from 'next/dynamic';\nimport Router from 'next/router';\nimport { toast } from 'react-toastify';\nimport AnimationRevealPage from \"../../helpers/AnimationRevealPage.jsx\";\nimport styled from \"styled-components\";\nimport { SectionHeading } from \"../misc/Headings.jsx\";\nimport { PrimaryButton } from \"../misc/Buttons.jsx\";\nimport { EDITOR_JS_TOOLS, Image } from '../../utils/tools';\nimport APIHelper from '../../helpers/APIHelpers';\nimport { generalHelpers } from '../../helpers/generalHelpers';\nimport AuthContext from '../../context/AuthContext';\nvar EditorJS = dynamic(function () {\n  return import('react-editor-js');\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('react-editor-js')];\n    },\n    modules: ['react-editor-js']\n  }\n});\nvar Column = styled.div.withConfig({\n  displayName: \"NewBlogPost__Column\",\n  componentId: \"sc-1ocdpki-0\"\n})({\n  \"display\": \"flex\",\n  \"flexDirection\": \"column\"\n});\nvar InputContainer = styled.div.withConfig({\n  displayName: \"NewBlogPost__InputContainer\",\n  componentId: \"sc-1ocdpki-1\"\n})({\n  \"position\": \"relative\",\n  \"paddingTop\": \"1.25rem\",\n  \"paddingBottom\": \"1.25rem\",\n  \"marginTop\": \"0.5rem\"\n}); // const SubmitButton = tw.button`w-full sm:w-32 mt-6 py-3 bg-primary-100 text-gray-100 rounded font-bold tracking-wide shadow-lg uppercase text-sm transition duration-300 transform focus:outline-none focus:shadow-outline hover:bg-gray-100 hover:text-primary-700 hocus:-translate-y-px hocus:shadow-xl`;\n\nvar SubmitButton = styled(PrimaryButton).withConfig({\n  displayName: \"NewBlogPost__SubmitButton\",\n  componentId: \"sc-1ocdpki-2\"\n})([\"\", \"\"], {\n  \"boxShadow\": \"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)\",\n  \"textTransform\": \"uppercase\",\n  \"fontSize\": \"0.875rem\",\n  \"transitionProperty\": \"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform\",\n  \"transitionDuration\": \"300ms\",\n  \"--transform-translate-x\": \"0\",\n  \"--transform-translate-y\": \"0\",\n  \"--transform-rotate\": \"0\",\n  \"--transform-skew-x\": \"0\",\n  \"--transform-skew-y\": \"0\",\n  \"--transform-scale-x\": \"1\",\n  \"--transform-scale-y\": \"1\",\n  \"transform\": \"translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y))\",\n  \":focus\": {\n    \"outline\": \"2px solid transparent\",\n    \"outlineOffset\": \"2px\",\n    \"boxShadow\": \"0 0 0 3px rgba(66, 153, 225, 0.5)\"\n  },\n  \":hover\": {\n    \"--bg-opacity\": \"1\",\n    \"backgroundColor\": \"rgba(247, 250, 252, var(--bg-opacity))\",\n    \"--text-opacity\": \"1\",\n    \"color\": \"rgba(54, 165, 222, var(--text-opacity))\"\n  },\n  \":hover, :focus\": {\n    \"--transform-translate-y\": \"-1px\",\n    \"boxShadow\": \"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)\"\n  }\n});\nvar FormContainer = styled.div.withConfig({\n  displayName: \"NewBlogPost__FormContainer\",\n  componentId: \"sc-1ocdpki-3\"\n})([\"text-align:center;\", \" #description{\", \"}input,textarea,p{text-align:center;\", \";::placeholder{\", \"}}.editable:empty:before{content:attr(data-placeholder);color:#a0aec0;}\"], {\n  \"borderRadius\": \"0.5rem\",\n  \"position\": \"relative\"\n}, {\n  \"fontSize\": \"1.125rem\",\n  \"--text-opacity\": \"1\",\n  \"color\": \"rgba(74, 85, 104, var(--text-opacity))\"\n}, {\n  \"width\": \"50%\",\n  \"backgroundColor\": \"transparent\",\n  \"fontSize\": \"2.25rem\",\n  \"fontWeight\": \"900\",\n  \"letterSpacing\": \"0.025em\",\n  \"borderBottomWidth\": \"0\",\n  \":hover, :focus\": {\n    \"--border-opacity\": \"1\",\n    \"borderColor\": \"rgba(141, 194, 64, var(--border-opacity))\"\n  },\n  \":focus\": {\n    \"outline\": \"2px solid transparent\",\n    \"outlineOffset\": \"2px\"\n  },\n  \"transitionProperty\": \"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform\",\n  \"transitionDuration\": \"200ms\"\n}, {\n  \"--text-opacity\": \"1\",\n  \"color\": \"rgba(160, 174, 192, var(--text-opacity))\"\n});\nvar Content = styled.div.withConfig({\n  displayName: \"NewBlogPost__Content\",\n  componentId: \"sc-1ocdpki-4\"\n})({\n  \"maxWidth\": \"1280px\",\n  \"marginLeft\": \"auto\",\n  \"marginRight\": \"auto\",\n  \"paddingTop\": \"5rem\",\n  \"paddingBottom\": \"5rem\",\n  \"@media (min-width: 1024px)\": {\n    \"paddingTop\": \"6rem\",\n    \"paddingBottom\": \"6rem\"\n  }\n});\nvar Container = styled.div.withConfig({\n  displayName: \"NewBlogPost__Container\",\n  componentId: \"sc-1ocdpki-5\"\n})({\n  \"display\": \"grid\",\n  \"gridTemplateColumns\": \"100vw\"\n});\n\nvar NewBlogPost = function NewBlogPost() {\n  var editorInstance;\n\n  var _React$useState = React.useState(''),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      data = _React$useState2[0],\n      setData = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      title = _React$useState4[0],\n      setTitle = _React$useState4[1];\n\n  var _React$useState5 = React.useState(null),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      instance = _React$useState6[0],\n      setInstance = _React$useState6[1];\n\n  var _React$useState7 = React.useState(''),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      description = _React$useState8[0],\n      setDescription = _React$useState8[1];\n\n  var defaultCoverImage = 'https://res.cloudinary.com/cello/image/upload/v1604774981/jess-bailey-q10VITrVYUM-unsplash_kcqo4m.jpg'; // body, title, description, tags, status,\n  //       coverImage,\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var savedData, images, coverImage, data, request;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (instance) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\", alert('no editor instance'));\n\n            case 2:\n              _context.next = 4;\n              return instance.save();\n\n            case 4:\n              savedData = _context.sent;\n              images = generalHelpers.getCoverImage(savedData.blocks);\n              coverImage = images.length > 0 ? images[0].file.url : defaultCoverImage;\n              data = {\n                title: title,\n                description: description,\n                coverImage: coverImage,\n                status: 'PUBLISHED',\n                body: JSON.stringify(savedData)\n              };\n              _context.prev = 8;\n              _context.next = 11;\n              return APIHelper.post('/blogs', data);\n\n            case 11:\n              request = _context.sent;\n              toast.success(request.data.message);\n              Router.push('/blog');\n              _context.next = 21;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](8);\n\n              if (!_context.t0.response) {\n                _context.next = 20;\n                break;\n              }\n\n              return _context.abrupt(\"return\", toast.error(_context.t0.response.data.message));\n\n            case 20:\n              return _context.abrupt(\"return\", toast.error('Something went wrong! Please try again'));\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[8, 16]]);\n    }));\n\n    return function handleSubmit() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var _React$useContext = React.useContext(AuthContext),\n      state = _React$useContext.state;\n\n  React.useEffect(function () {\n    if (!state.isAuthenticated) {\n      Router.push('/blog');\n    }\n\n    if (state.isAuthenticated && state.user.userType === \"REQUESTER\") {\n      Router.push('/blog');\n    }\n  }, []);\n  return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, \"Kath\\u0113kon - Blog Posts\"), __jsx(\"meta\", {\n    name: \"description\",\n    content: \"Kathekon Blog, read enlightening artcules and personal discoveries by our team on the journey to transforming society for the better.\"\n  }), __jsx(\"meta\", {\n    name: \"keywords\",\n    content: \"kathekon kath\\u0113kon blog articles posts stories scholarships transforming nigeria education civil society social welfare investment africa\"\n  })), __jsx(AnimationRevealPage, null, __jsx(Container, null, __jsx(FormContainer, null, __jsx(\"center\", null, __jsx(\"form\", {\n    action: \"#\"\n  }, __jsx(Column, null, __jsx(InputContainer, null, __jsx(\"p\", {\n    suppressContentEditableWarning: true,\n    \"data-placeholder\": \"Title...\",\n    className: \"editable\",\n    onInput: function onInput(event) {\n      setTitle(event.target.innerHTML);\n    },\n    contentEditable: true\n  })), __jsx(InputContainer, null, __jsx(\"p\", {\n    suppressContentEditableWarning: true,\n    id: \"description\",\n    \"data-placeholder\": \"Description...\",\n    className: \"editable\",\n    onInput: function onInput(event) {\n      return setDescription(event.target.innerHTML);\n    },\n    contentEditable: true\n  })))))), __jsx(\"div\", {\n    id: \"blogPost\"\n  }, __jsx(EditorJS, {\n    instanceRef: function instanceRef(instance) {\n      console.log(editorInstance);\n      editorInstance = instance;\n      setInstance(instance);\n    },\n    data: data,\n    tools: _objectSpread(_objectSpread({}, EDITOR_JS_TOOLS), {}, {\n      image: {\n        \"class\": Image,\n        config: {\n          endpoints: {\n            byFile: '/api/v1/upload-image',\n            // Your backend file uploader endpoint\n            byUrl: '/api/v1/upload-image' // Your endpoint that provides uploading by Url\n\n          },\n          uploader: {\n            uploadByFile: function uploadByFile(file) {\n              var unsignedUploadPreset = 'klhmvqzf';\n              var formData = new FormData();\n              formData.append('upload_preset', unsignedUploadPreset);\n              formData.append('file', file);\n              return Axios.post('/api/v1/upload-image', formData).then(function (response) {\n                return response.data;\n              });\n            }\n          }\n        }\n      }\n    })\n  }), __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      alignContent: 'center',\n      alignItems: 'center'\n    }\n  }, __jsx(SubmitButton, {\n    onClick: function onClick() {\n      return handleSubmit();\n    }\n  }, \"Publish\"))))));\n};\n\nexport default NewBlogPost;","map":null,"metadata":{},"sourceType":"module"}